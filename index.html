<head>
    <link href="zesty.png" type="image/x-icon" rel="icon">
    <link rel="apple-touch-icon" href="zesty.png">
    <title>spotify modded</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #202020;
            color: #ffffff;
        }

        #left {
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow-y: auto;
        }

        button {
            background-color: rgb(255, 255, 255);
            border: none;
            color: rgb(0, 0, 0);
            padding: 10px 20px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            cursor: pointer;
            border-radius: 5px;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #969696;
        }

        #home, #searchcontent {
            padding: 20px;
        }

        #home h1 {
            margin-top: 0;
        }

        #home img, .songsearch img, .playlisti img {
            border-radius: 5px;
            box-shadow: 0 4px 8px #333;
        }

        #searchcontent img {
            margin: 10px 0;
        }

        .playlisti, .songsearch {
            background-color: #2e2e2e;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .playlisti h4, .songsearch h3 {
            margin-top: 0;
        }

        #player {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: #333;
            color: #fff;
            padding: 10px;
            border-top: 1px solid #444;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.2);
        }

        #player img {
            width: 80px;
            height: auto;
            margin-right: 15px;
        }

        #player b, #player p {
            margin: 0 15px;
            color: #f1f1f1;
        }

        #player audio {
            margin-left: 15px;
        }

        #playlist {
            display: flex;
            flex-direction: column;
        }

        #playlist .playlisti {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        #playlist button {
            margin-left: auto;
        }
    </style>
</head>

<div id="left">
    <button id="homeb">Home (your playlist)</button>
    <button id="searchb">Search For Music</button>
    <div id="home">
        <h1>yuo r on home</h1>
        <img src="zesty.png" width="100px" height="100px">
        <p>yuor playlist:</p>
        <hr>
        <div id="playlist">
        </div>

    </div>
    <div id="searchcontent" style="display: none;">
        

    </div>
    <p>spotify modded since 2024</p>
    <br><br><br><br><br><br><br><br><br><br><br><br><br><br>
    <div id="player">
        <img id="fgersi0sefdjhi" width="100px" src="">
        <b id="songname">Loading...</b>
        <p id="rappername">Loading...</p>
        <audio id="audioPlayer" controls>
            <source id="audioSource" src="" type="audio/mpeg">
        </audio>
        <button onclick="nextSong()">Next Song</button>
        <button onclick="previousSong()">Prev Song</button>
    </div>
</div>
<script>
    function delay(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }

    let playlist = localStorage.getItem("playlist")
    if (!playlist) {
        playlist = [["IjIwMjQiIHByb2QuIG9qaXZvbHRhLCBlYXJsb250aGViZWF0LCBhbmQgS2FueWUgV2VzdA==","WUczRWhXbEJhb0k=","aHR0cHM6Ly9pLnl0aW1nLmNvbS92aS9ZRzNFaFdsQmFvSS9ocTcyMC5qcGc/c3FwPS1vYXltd0VjQ09nQ0VNb0JTRlh5cTRxcEF3NElBUlVBQUloQ0dBRndBY0FCQmc9PSZycz1BT240Q0xEWm1xV0FzWVJ5dTFzS3JHRTEzcDd2ZmZiRnB3","MzozMA==","UGxheWJvaSBDYXJ0aQ=="]]
    } else {
        playlist = JSON.parse(playlist)
    }

    let playing = 0

    let servers = [
        "i0fa9780fas0f",
        "fajdfhs908fhsd",
    ]
    //https://glitch.com/edit/#!/remix/i0fa9780fas0f
    function getRandomServer() {
        const randomIndex = Math.floor(Math.random() * servers.length);
        return servers[randomIndex];
    }

    function pingallservers() {
        for (const i of servers) {
            fetch(i + "/lol")
        }
    }
    pingallservers()


        const audioElement = document.getElementById("audioPlayer");

        audioElement.addEventListener('ended', () => {
            playing += 1;
            if (playing >= playlist.length) {
                playing = 0;
            }
            playNextSong();
        });

        function playNextSong() {
            const song = playlist[playing];

            document.getElementById("songname").textContent = atob(song[0]);
            document.getElementById("rappername").textContent = atob(song[4]);
            document.getElementById("fgersi0sefdjhi").src = atob(song[2]);
            document.getElementById("audioSource").src = `https://${getRandomServer()}.glitch.me/?ytid=` + atob(song[1]);

            audioElement.load();
            audioElement.play();
        }

        playNextSong();
    

    function previousSong() {
        playing -= 1;
        if (playing < 0) {
            playing = playlist.length - 1;
        }
        playNextSong();
    }

    function nextSong() {
        playing += 1;
        if (playing >= playlist.length) {
            playing = 0;
        }
        playNextSong();
    }


    async function addtoplaylist(songname, youtubeid, thumbnail, length, artist) {
        const isAlreadyInPlaylist = playlist.some(item => item[1] === youtubeid);

        if (!isAlreadyInPlaylist) {
            playlist.push([songname, youtubeid, thumbnail, length, artist]);
            localStorage.setItem("playlist", JSON.stringify(playlist));
            alert(`Song ${atob(songname)} added to the playlist.`);
        } else {
            alert(`Song ${atob(songname)} is already in the playlist.`);
        }
    }

    async function delsong(songid) {
        if (confirm(`r u sure u wanna remove such a great song ${atob(playlist[songid][0])}`)) {
            playlist.splice(songid, 1);
            localStorage.setItem("playlist", JSON.stringify(playlist));
            alert("removed from palylisy ðŸ˜‚ðŸ˜")
            renderplaylist()
        }
    }

    async function jmp(songid) {
        playing = songid;
        if (playing >= playlist.length) {
            playing = 0;
        }
        if (playing < 0) {
            playing = playlist.length - 1;
        }
        playNextSong();
    }

    async function renderplaylist() {
                 document.getElementById("playlist").innerHTML = ""
        let p = 0
        for (const i of playlist) {
            let v = `<div class="playlisti">
                <img src="${atob(i[2])}" width="100px">  
                <h4>${atob(i[0])}</h4>
                <h6>${atob(i[4])}</h6>
                <p>${atob(i[3])}</p>
                <button onclick="jmp('${p}')">Play</button>
                <button onclick="delsong('${p}')">Delete from playlist</button>
                <hr>
            </div>`
            document.getElementById("playlist").innerHTML += v
            p += 1
         }
    }
    renderplaylist()
    document.getElementById("homeb").onclick = async function() {
        document.getElementById("home").style.display = ""
         document.getElementById("searchcontent").style.display = "none"
         renderplaylist()
    }


    document.getElementById("searchb").onclick = async function() {
                document.getElementById("home").style.display = "none"
     document.getElementById("searchcontent").style.display = ""

        const query = prompt("Enter a search: ")
        document.getElementById("searchcontent").innerHTML = `<p>Loading results for "${query}"</p>`
        const r = await fetch(`https://${getRandomServer()}.glitch.me/proxy?query=${query}`)
        const vids = await r.json()

        document.getElementById("searchcontent").innerHTML = `<img src="3838.jpg" width="100px" height="100px">`

        let results = 0

        document.getElementById("searchcontent").innerHTML += `Results for "${query}"`
        for (const i of vids) {
            if (i["videoRenderer"] ) {
                try {
                    console.log(i)
                const mainshit = i["videoRenderer"]
                const songname = mainshit.title.runs[0].text
                const artist = mainshit.ownerText.runs[0].text
                const cover = mainshit.thumbnail.thumbnails[0].url
                const ytid = mainshit.videoId
                const len = mainshit.lengthText.simpleText


                const vi = `
                <div class="songsearch">
                    <h3>${songname}</h3>
                    <h6>${artist}</h6>
                    <img src="${cover}">
                    <button onclick="addtoplaylist('${btoa(songname)}', '${btoa(ytid)}', '${btoa(cover)}', '${btoa(len)}', '${btoa(artist)}')">Add to Playlist</button>
                    <hr>
                </div>
                `

                document.getElementById("searchcontent").innerHTML += vi
                results += 1
                } catch (err) {
                    console.log(err)
                }



            }
        }
        if (results < 1) {
            document.getElementById("searchcontent").innerHTML += "<h1>no results found you fucking bitch</h1>"
        }
    }

</script>
